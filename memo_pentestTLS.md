# Mémo pentest configuration SSL/TLS

## Obtenir toutes les versions supportées par le serveur

    nmap --script +ssl-enum-ciphers -p PORT HOST 
    
## Etablir des connexions SSL/TLS en choisissant la version et la suite de chiffrement

Pour vérifier les tailles des clefs utilisées (clefs de chiffrement ou clef publique du serveur), les courbes utilisées (ECDH) 
et les options supportées par le serveur en fonction de la suite de chiffrement (compression, support de la renegociation sécurisée des clefs, extensions TLS)

    openssl s_client -connect HOST:PORT [-TLS_VERSION] [-cipher CIPHER_LIST]
   
> Remarques : 
> * TLS_VERSION: La version de TLS à utiliser pour l'échange : tls1_2, tls1_1, tls1, ssl3
> * CIPHER_LIST: La suite de chiffrement à utiliser pour l'échange. 

Par exemple pour lister les suites de chiffrement disponibles contenant RSA :

    openssl ciphers -v 'RSA'
Pour plus d'options : [OpenSSL.org](https://www.openssl.org/docs/man1.1.0/apps/ciphers.html)

Pour tester la présence de la protection anti downgrade ssl

    openssl s_client -connect HOST:PORT -fallback_scsv [-TLS_VERSION]
    
> Remarque : fallback_scsv avertit le serveur (ajout d'une cipher_suite factice dans le client_hello) qu'il doit fermer la connection si le client ne se connecte pas avec la version TLS la plus résistante disponible. Si le serveur accepte la connexion, il est mal configuré.
 


    




